<!DOCTYPE html>
<html lang="en" dir="">
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{fragments/modules/base/head :: head}"></head>
    <body>
        <!--[if lt IE 8]>
            <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
        <![endif]-->

        <div class="wrapper">
			<!-- header top menu Start -->
			 <header th:replace="~{fragments/modules/base/header :: header}"></header>
			<!-- header top menu end -->

            <div class="page-wrap">
				<!--=============== Left Menu side Start ================-->
				<div th:replace="~{fragments/modules/base/menu :: menu}"></div>
				<!--=============== Left side End ================-->
                <div class="main-content">
                    <div class="container-fluid">
                        <div class="page-header">
                            <div class="row align-items-end">
                                <div class="col-lg-8">
                                    <div class="page-header-title">
                                        <i class="far fa-calendar-plus bg-blue"></i>
                                        <div class="d-inline">
                                            <h5 th:utext="'Petition Acknowledgement ('+${petitionNo}+')'">Petition Acknowledgement</h5>
                                            <span>Commissioner Petition</span>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-lg-4">
                                    <nav class="breadcrumb-container" aria-label="breadcrumb">
                                        <ol class="breadcrumb">
                                            <li class="breadcrumb-item">
                                                <a href="index"><i class="ik ik-home"></i></a>
                                            </li>
                                            <li class="breadcrumb-item" aria-current="page">Commissioner Petition</li>
                                            <li class="breadcrumb-item active" aria-current="page">Petition Acknowledgement</li>
                                        </ol>
                                    </nav>
                                </div>
                            </div>
                        </div>
                        <hr class="print_no">
                        <!-- 
                        <div class="row">
                        	<div class="col-lg-6">
								<div class="block block-rounded ack ack-container">
									<div id="ack1table" style="border: 1px solid black;">
										<div id="ack1"></div>
									</div>
								</div>
							</div>
						 
							<div class="col-lg-6">
								<div class="block block-rounded ack ack-container">
									<div id="ack2table" style="border: 1px solid black;">
										<div id="ack2"></div>
									</div>
								</div>
							</div>
		   	 	            <div class="col-lg-12 text-center block-options pt-10">
		   	 					<button type="button" class="btn btn-warning btn-rounded btn-block-option" onclick="window.print()"><i class="ik ik-printer"></i> Print</button>
		   	 	            </div>
                        </div>
                         -->
                        <div class="row">
						    <div class="col-lg-6">
						        <div class="block block-rounded ack ack-container">
						            <div id="ack1table" class="ack-content">
						                <div id="ack1">This is ack1</div>
						            </div>
						        </div>
						    </div>
						    
						    <div class="col-lg-6 printack2">
						        <div class="block block-rounded ack ack-container">
						            <div id="ack2table" class="ack-content">
						                <div id="ack2">This is ack2</div>
						            </div>
						        </div>
						    </div>
						    <div class="col-lg-12 text-center block-options pt-10">
						        <button type="button" class="btn btn-warning btn-rounded btn-block-option" onclick="window.print()"><i class="ik ik-printer"></i> Print</button>
						    </div>
						</div>
						                        
                    </div>
                </div>

                <footer th:replace="~{fragments/modules/base/footer :: footer}"></footer>
            </div>
        </div>
       
        
        <div th:replace="~{fragments/modules/base/app_module_menu_box :: div}"></div>
       	
        <script th:replace="~{fragments/modules/base/script :: script}"></script>
        <script th:replace="~{fragments/modules/zerohours_petition/script :: script}"></script>
       	<script th:inline="javascript">
			var createdBy = /*[[${LoginUserId}]]*/'';
			var petitionNo = /*[[${petitionNo}]]*/'';
			var complaintTypeList = "";
			
			 /* Get Complaint Type Data */
			function get_complaint_type_data(){
			
				get_complaint_type_list().then(function(complaintTypes) {
				    // Handle the Complaint list
				    complaintTypeList = complaintTypes;
					
				    // After Complaint Type list created we call petition details
				    get_petition_data();
				    
				}).catch(function(error) {
				    // Handle errors
				    console.error('Error fetching complaint type list:', error);
				});
			}
			
			 /* Get Petition data */
			function get_petition_data(){
				get_petition_details().then(function(petitionDetails) {
				    // Handle the Complaint list
				    var complaintHTML = "";
					var complaint = petitionDetails[0].petitioner_complaint_txt;
					
					var complaintArray = complaint.split(',');
					
					for(j = 0; j < complaintArray.length; j++){
						if(j>0){
							complaintHTML+="<br>";
						}
						complaintHTML+= (j+1)+') '+complaintArray[j];
					}
					var ack =`
					<table class="table table-borderless table-vcenter p-0 m-0">
					  <tbody>
					    <tr>
					      <td scope="row"><img src="images/logo-sm.png" width="80px"/></td>
					      <td class="fw-semibold text-center">
								<b>பெருநகர சென்னை மாநகராட்சி | Greater Chennai Corporation<br>
								மக்களை தேடி மேயர் திட்டம்<br>
								ஒப்புகை சீட்டு / Acknowledgement Receipt</b>
						  </td>
						  <td scope="row"><img src="images/logo-sm.png" width="80px"/></td>
					    </tr>
					</tbody>
					</table>
					<hr style="margin:0px">
					  <div class="block-content p-0 m-0">
					    <table class="table table-borderless table-vcenter" style="font-size:12px;">
					      <tbody>
					        <tr>
					          <th style="padding: 0.45rem 0.45rem;">நாள் / Date : </th>
					          <td class="fw-semibold" style="padding: 0.45rem 0.45rem;">
					           ${convertdate(petitionDetails[0].cdate)}
					          </td>
					        </tr>
					        <tr>
					          <th style="padding: 0.45rem 0.45rem;">ஒப்புகை சீட்டு எண்/ Acknowledgement No:</th>
					          <td class="fw-semibold" style="padding: 0.45rem 0.45rem;">
					           ${petitionDetails[0].petition_no}
					          </td>
					        </tr>
					        <tr>
					          <th style="padding: 0.45rem 0.45rem;">பெயர் / Name :</th>
					          <td class="fw-semibold" style="padding: 0.45rem 0.45rem;">
					           ${petitionDetails[0].petitioner_name}
					          </td>
					        </tr>
					        <tr>
					          <th style="padding: 0.45rem 0.45rem;">கைபேசி எண் / Mobile No.</th>
					          <td class="fw-semibold" style="padding: 0.45rem 0.45rem;">
					           ${petitionDetails[0].petitioner_mobile}
					          </td>
					        </tr>
					        <tr style="font-size:12px;">
					          <th style="padding: 0.45rem 0.45rem;">புகாரின் தன்மை / Nature of complaint:</th>
					          <td class="fw-semibold" style="padding: 0.45rem 0.45rem;">
					           ${complaintHTML}
							</td>
					        </tr>
					        <tr>
					          <td scope="row" colspan="2" style="font-size:10px">இம்மனுவின் ஒப்புகைச் சீட்டு எண் மனு தாரரின் கைபேசி எண்ணிற்கு குறுஞ்செய்தி மூலம் அனுப்பி வைக்கப்படும் . இம்மனுவின் நிலை குறித்து https://chennaicorporation.gov.in/MTM/ என்ற இணையதளத்தில் மனுவின் எண்ணை குறிப்பிட்டு அறிந்துகொள்ளலாம்</th>
					        </tr>
					        <tr style="text-align: right;">
					          <th scope="row" colspan="2" style="padding: 0.45rem 0.45rem;">வட்டார அலுவலகம்<br>Office of the Regional Deputy Commissioner</th>
					        </tr>
					      </tbody>
					    </table>
					  `;
				    
					$("#ack1").html(ack);
					$("#ack2").html(ack);
					  
				}).catch(function(error) {
				    // Handle errors
				    console.error('Error fetching petition details ('+petitionNo+'):', error);
				});
			}
			 
			/* Get Petition details by petition number */
			
			function get_petition_details() {
			    
				var formData = new FormData();
		        formData.append('petitionNo',petitionNo);
		        
				var apiUrl = '/gcc/api/zerohours_petition/getPetitionDetails?petitionNo='+petitionNo;
			    // Return a Promise
			    return new Promise(function(resolve, reject) {
			        $.ajax({
			            url: apiUrl,
			            type: 'GET',
			            //data: formData,
			            dataType: 'json',
			            success: function(jsonResponse) {
			                // Resolve the Promise with the department list
			                resolve(jsonResponse);
			            },
			            error: function(xhr, status, error) {
			                // Reject the Promise with the error message
			                console.error('Error fetching petition details ('+petitionNo+'):', error);
			                reject(error);
			            }
			        });
			    });
			}
			
			$(document).ready(function() {
				get_complaint_type_data();
			});
		</script>
    </body>
</html>
