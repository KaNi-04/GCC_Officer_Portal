<!DOCTYPE html>
<html lang="en" dir="">
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{fragments/modules/base/head :: head}"></head>
<style>

    #QaqcDatatable th, #QaqcDatatable td {
        text-align: center;
    }

.modal-dialog {
    max-width: 80%; /* Adjust width as needed */
}
.modal-header {
    background-color: #007bff;
    color: #fff;
}
.modal-title {
    font-weight: bold;
}


.boxcard {
	height: 100px;
	border-radius: 20px;
}


 .required{
	color: red;
}
.card-box {
       	box-shadow: rgba(0, 0, 0, 0.5) 0px 3px 8px;
    }
    
@media (max-width: 768px) {
    .card-box {
        text-align: center;
    }

}
</style>
    <body>
		
        <!--[if lt IE 8]>
            <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
        <![endif]-->

        <div class="wrapper">
			<!-- header top menu Start -->
			 <header th:replace="~{fragments/modules/base/header :: header}"></header>
			<!-- header top menu end -->

            <div class="page-wrap">
				<!--=============== Left Menu side Start ================-->
				<div th:replace="~{fragments/modules/base/menu :: menu}"></div>
				<!--=============== Left side End ================-->
                <div class="main-content">
                    <div class="container-fluid">
                        <div class="page-header mb-2">
						<div class="row align-items-end">
							<div class="col-lg-6">
								<div class="page-header-title">
									<i class="fas fa-user-graduate bg-blue"></i>
									<div class="d-inline">	
										<h5>QAQC Agent Performance</h5>
										<span>1913 Agent Performance</span>
									</div>
								</div>
							</div>
							<div class="col-lg-6">
								<nav class="breadcrumb-container" aria-label="breadcrumb">
									<ol class="breadcrumb">
										<li class="breadcrumb-item"><a href="/gcc/index"><i
												class="ik ik-home"></i></a></li>
										<li class="breadcrumb-item" aria-current="page">1913 Reports</li>
										<li class="breadcrumb-item active" aria-current="page">Agent Performance</li>
									</ol>
								</nav>
							</div>
						</div>
					</div>
                        
                      
                      <div class="row mt-4">
 
                      
                      <div class="col-md-12">
                             <div class="card">
                             	<div class="card-header">
                             		<h3>Agent Performance</h3>
                             	</div>
                             	<div class="row mt-3 ml-2">
									
									    <div class="col-md-3">
									        <label for="startDate" class="form-label" style="font-size: medium;">From Date:</label>
									        <input type="date" id="startDate" class="form-control">
									    </div>
									    <div class="col-md-3">
									        <label for="endDate" class="form-label" style="font-size: medium;">To Date:</label>
									        <input type="date" id="endDate" class="form-control">
									    </div>
									    <div class="col-md-3" style="margin-top: 30px;">
									        <button id="searchBtn" class="btn btn-primary">Search</button>
									        <button id="resetBtn" class="btn btn-secondary">Reset</button>
									    </div>
									
									</div>


                             	<div class="card-body">
                             		
										<div>
										    <div class="row mt-2">
										        <div class="col-xl-3 col-md-12">
										            <div class="card card-box p-4">
										                <p class="text-facebook mb-20 text-center mt-2"><b>No Of Agents</b></p>
										                <h3 class="text-twitter fw-700 ml-5 text-center" id="totalnoofagentsCount"></h3>
										            </div>
										        </div>
										        
										        <div class="col-xl-3 col-md-4">
										            <div class="card card-box p-4">
										                <p class="text-facebook mb-20 text-center mt-2"><b>Assigned Calls</b></p> 
										                <h3 class="text-twitter fw-700 ml-5 text-center" id="totalassignedCount"></h3>
										            </div>
										        </div>
										        <div class="col-xl-3 col-md-4">
										            <div class="card card-box p-4">
										                <p class="text-facebook mb-20 text-center mt-2"><b>Finished</b></p> 
										                <h3 class="text-twitter fw-700 ml-5 text-center" id="totalcompleteCount"></h3>
										            </div>
										        </div>
										        <div class="col-xl-3 col-md-4">
										            <div class="card card-box p-4">
										                <p class="text-facebook mb-20 text-center mt-2"><b>Pending Calls</b></p> 
										                <h3 class="text-twitter fw-700 ml-5 text-center" id="totalpendingCount"></h3>
										            </div>
										        </div>
										    </div>
										
										    <div class="cards">
										        <table id="QaqcDatatable" class="table table-striped table-bordered table-hover dataTable" role="grid">
										            <thead class="thead-dark">
										                <tr role="row">
										                    <th rowspan="2" class="text-center">S.No</th>
										                    <th rowspan="2" class="text-center">Agent Name</th>
										                    <th colspan="4" class="text-center">Performance</th>
							                            	<th colspan="4" class="text-center">Call Results</th>
							                            </tr>
							                       		<tr role="row">
										                    <th class="text-center no-sort">Assigned Calls</th>							                            
								                            <th class="text-center no-sort">Finished</th>
								                            <th class="text-center no-sort">Pending Calls</th>
								                            <th class="text-center no-sort">Completion(%)</th>
								                            <th class="no-sort">Completed</th> 
								                            <th class="no-sort">Reopen</th>
								                            <th class="no-sort">Followup</th>
								                            <th class="no-sort">Others</th>
										                </tr>
										            </thead>
										            <tbody>
										                <!-- Data will be populated here -->
										            </tbody>
										        </table>
										    </div>
										</div>
                             	</div>						 
							 </div>
                         </div> 
					
						

						
                      </div>
                        
                    </div>
                </div>
                
                <div id="pageLoader" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(255, 255, 255, 0.8); z-index: 9999; text-align: center;">
				    <div style="position: relative; top: 50%; transform: translateY(-50%);">
				        <div class="spinner-border text-primary" role="status" style="width: 3rem; height: 3rem;">
				            <span class="sr-only">Loading...</span>
				        </div>
				        <!-- Add the 'Please wait' text below the spinner -->
				        <p style="margin-top: 1rem; font-size: 1.2rem; color: #007bff;">Please wait...</p>
				    </div>
				</div>

                <footer th:replace="~{fragments/modules/base/footer :: footer}"></footer>
            </div>
        </div>
        
        
<!--agentperformance Modal -->
		<div class="modal fade" id="agentperformance" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterLabel" aria-hidden="true">
            <div class="modal-dialog modal-xl" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="exampleModalCenterLabel">Task Details</h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    </div>
                    
                    <div class="modal-body">
						<div class="table-responsive" >
						<table id="agentperformanceDatatable" class="table table-striped table-bordered table-hover dataTable" role="grid" >
                              <thead class="thead-dark">
                                 	<tr role="row">
                            <th rowspan="2" class="text-center">S.No</th>
                            <th rowspan="2" class="text-center">TaskId</th>
                            <th rowspan="2" class="text-center" width="100px;">Date</th>                           
                            <th colspan="4" class="text-center">Performance</th>
                            <th colspan="4" class="text-center">Call Results</th>
                        </tr>
                        <tr role="row">          
                            <th class="text-center">Assigned Calls</th>
                            <th class="text-center">Finished</th>
                            <th class="text-center">Pending Calls</th>
                            <th class="text-center no-sort">Completion (%)</th>
                            <th class="text-center no-sort">Completed</th>
                            <th class="text-center no-sort">Reopen</th>
                            <th class="text-center no-sort">Followup</th>
                            <th class="text-center no-sort">Others</th>
                            
                        </tr>
						 </thead>
                         <tbody>
                                    
                         </tbody>
                               
                       </table>
						</div>
                     </div>
  					
  					<div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                        
                    </div>                                        
                </div>
            </div>
        </div>
        
        
        <!-- Assign Task Details Modal -->
		<div class="modal fade" id="Assignagentperformance" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterLabel1" aria-hidden="true">
		    <div class="modal-dialog modal-xl" role="document">
		        <div class="modal-content">
		            <div class="modal-header">
		                <h5 class="modal-title" id="exampleModalCenterLabel1">Assign Task Details</h5>
		                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
		                    <span aria-hidden="true">&times;</span>
		                </button>
		            </div>
		            
		            <div class="modal-body">
		                <div class="table-responsive">
		                    <table id="AssignagentperformanceDatatable" class="table table-striped table-bordered table-hover dataTable" role="grid">
		                        <thead class="thead-dark">
		                            <tr role="row">
		                                <th class="text-center">S.No</th>
		                                
		                                <th class="text-center">Call Category</th>
		                                <th class="text-center">Complaint Number</th>
		                                <th class="text-center">Complaint Date</th>
		                                <th class="text-center">Complaint Person Name</th>
		                                <th class="text-center">Complaint Mob no</th>
		                                <th class="text-center">Complaint Type</th>
		                                <th class="text-center">Official Name</th>
		                                <th class="text-center">Official Ph no</th>
		                                <th class="text-center">Call Status</th>
		                                <th class="text-center">Remarks</th>
		                                <!-- <th class="text-center">Updated Date</th> -->
		                            </tr>
		                        </thead>
		                        <tbody>
		                            <!-- Dynamic content will be populated here -->
		                        </tbody>
		                    </table>
		                </div>
		            </div>
		            
		            <div class="modal-footer">
		                <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
		            </div>
		        </div>
		    </div>
		</div>	
               
    
        <div th:replace="~{fragments/modules/base/app_module_menu_box :: div}"></div>
       
        <script th:replace="~{fragments/modules/base/script :: script}"></script>     
        <script src="node_modules/tempusdominus-bootstrap-4/build/js/tempusdominus-bootstrap-4.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
        
         <script type="text/javascript">
         
        	 $(document).ready(function() { 
        		        	        		 
        		 $('#agentperformance').on('shown.bs.modal', function () {

         	    	 var buttons = [
         	             {
         	                 extend: 'pageLength',
         	                 className: 'btn btn-warning'
         	             },
         	             {
         	                 title: 'Data export',
         	                 extend: 'copyHtml5',
         	                 text: 'Copy',
         	                 className: 'btn btn-secondary'
         	             },
         	             {
         	                 extend: 'excelHtml5',
         	                 text: 'Excel',
         	                 className: 'btn btn-secondary'
         	             },
         	             {
         	                 extend: 'csvHtml5',
         	                 text: 'CSV',
         	                 className: 'btn btn-secondary'
         	             },
         	             {
         	                 extend: 'pdfHtml5',
         	                 text: 'PDF',
         	                 className: 'btn btn-secondary'
         	             }
         	         ];
         	        
         	            $('#agentperformanceDatatable').DataTable({
         	                dom: 'Bftip',               
         	                columnDefs: [
         	                    { targets: 'no-sort', orderable: false }
         	                ],
         	                lengthMenu: [
         	                    [50, 100, 200, 500, -1],
         	                    ['50 rows', '100 rows', '200 rows', '500 rows', 'Show all']
         	                ],
         	                scrollY: '50vh',
         	                scrollX: true,  // Enable horizontal scrolling	
         	                fixedColumns: {
         	                    left: 1,
         	                    right: 1
         	                },
         	                buttons: buttons,
         	                fixedHeader: false,
         	                autoWidth: false,
         	                responsive: true,
         	                searching: true,
         	                select: false,
         	                processing: false,
         	            });
         	        	
         	        
         	    });
            	 
            	 
            	 $('#Assignagentperformance').on('shown.bs.modal', function () {

         	    	 var buttons = [
         	             {
         	                 extend: 'pageLength',
         	                 className: 'btn btn-warning'
         	             },
         	             {
         	                 title: 'Data export',
         	                 extend: 'copyHtml5',
         	                 text: 'Copy',
         	                 className: 'btn btn-secondary'
         	             },
         	             {
         	                 extend: 'excelHtml5',
         	                 text: 'Excel',
         	                 className: 'btn btn-secondary'
         	             },
         	             {
         	                 extend: 'csvHtml5',
         	                 text: 'CSV',
         	                 className: 'btn btn-secondary'
         	             },
         	             {
         	                 extend: 'pdfHtml5',
         	                 text: 'PDF',
         	                 className: 'btn btn-secondary'
         	             }
         	         ];
         	       
         	            $('#AssignagentperformanceDatatable').DataTable({
         	                dom: 'Bftip',               
         	                columnDefs: [
         	                    { targets: 'no-sort', orderable: false }
         	                ],
         	               lengthMenu: [
        	                    [50, 100, 200, 500, -1],
        	                    ['50 rows', '100 rows', '200 rows', '500 rows', 'Show all']
        	                ],
         	                scrollY: '30vh',
         	                scrollX: true,  // Enable horizontal scrolling	
         	                fixedColumns: {
         	                    left: 1,
         	                    right: 1
         	                },
         	                buttons: buttons,
         	                fixedHeader: false,
         	                autoWidth: false,
         	                responsive: true,
         	                searching: true,
         	                select: false,
         	                processing: false,
         	            });
         	        
         	        
         	    });
        	 
          	var table = $('#QaqcDatatable').DataTable({
                  dom: 'Bftip',
                  columnDefs: [
                      { targets: 'no-sort', orderable: false }
                  ],
                  lengthMenu: [
                      [50, 100, 200, 500, -1],
                      ['50 rows', '100 rows', '200 rows', 'Show all']
                  ],
                  scrollY: '50vh',
                  fixedColumns: {
                      left: 1,
                      right: 1
                  },
                  buttons: [
                      {
                          extend: 'pageLength',
                          className: 'btn btn-warning'
                      },
                      {
                          title: 'Data export',
                          extend: 'copyHtml5',
                          text: 'Copy',
                          className: 'btn btn-secondary',
                          id: 'copyBtn'
                      },
                      {
                          extend: 'excelHtml5',
                          text: 'Excel',
                          className: 'btn btn-secondary',
                          id: 'excelBtn'
                      },
                      {
                          extend: 'csvHtml5',
                          text: 'CSV',
                          className: 'btn btn-secondary',
                          id: 'csvBtn'
                      },
                      {
                          extend: 'pdfHtml5',
                          text: 'PDF',
                          className: 'btn btn-secondary',
                          id: 'pdfBtn'
                      }
                  ],
                  fixedHeader: true,
                  autoWidth: true,
                  responsive: true,
                  searching:true,
                  select: false,
                  processing: false
              });
          	
                   	
          	 // Initialize DataTable with export buttons
            

        
                 const overallcountapiUrl = "/gcc/api/callcenterqaqc/agent/getagentperformancecount"; // Replace with your API endpoint
     		     const tableApiUrl = "/gcc/api/callcenterqaqc/agent/getagentperformancelist";
               
                 
                 
                 const totalagents = document.getElementById("totalnoofagentsCount");
         	   
         	    const assignedcallscount = document.getElementById("totalassignedCount");
         	    const totalcompletedcount = document.getElementById("totalcompleteCount");
         	    const pendingcallscount = document.getElementById("totalpendingCount");
         	    /* const dataTableElement = $("#QaqcDatatable").DataTable(); // Initialize DataTable
                  */
                 // Fetch Data Function
         	    const fetchData = async (startDate = "", endDate = "") => {
         	    	
         	        try {
         	            const params = new URLSearchParams();
         	            if (startDate) params.append("startDate", startDate);
         	            if (endDate) params.append("endDate", endDate);

         	            const response = await fetch(`${overallcountapiUrl}?${params.toString()}`);
         	            const data = await response.json();
         				
         	            //console.log(data);
         	            // Update Summary Counts
         	            const firstItem = data[0];  // Get the first object from the array
         	            totalagents.textContent = firstItem.no_of_agents || 0;          	            
         	            assignedcallscount.textContent = firstItem.total_calls || 0;  
         	            totalcompletedcount.textContent = firstItem.completed_calls || 0; 
         	            pendingcallscount.textContent = firstItem.pending_calls || 0; 
                  } catch (error) {
         	            console.error("Error fetching data:", error);
         	        }
         	    };
         	
         	
         	//fetchData();
         	
         // Fetch and Populate Table Data Function
         const fetchTableData = async (startDate = "", endDate = "") => {
        	 $('#pageLoader').show();
             try {
                 const params = new URLSearchParams();
                 if (startDate) params.append("startDate", startDate);
                 if (endDate) params.append("endDate", endDate);

                 const response = await fetch(`${tableApiUrl}?${params.toString()}`);
                 const tableData = await response.json();

                 // Update DataTable with new data
                 table.clear(); // Clear existing data
                 tableData.forEach((row, index) => {
                     
                         
                         const percentage = row.Assigned
                         ? Math.round((row.TotalCompleted / row.Assigned) * 100)
                         : 0;

                     table.row.add([
                     	
                     	`<div style="text-align: center;">${index + 1}</div>`,
                         `<button class="btn btn-success" data-agentId="${row.agent_id}" 
                         onclick="handleTaskButtonClick('${row.agent_id}')">${row.agent_name}</button>`,                         
                        /*  `<button class="btn btn-success" data-agentId="${row.agent_id}" 
                         onclick="handleAssignTaskButtonClick('${row.agent_id}')">${row.Assigned}</button>`, */
                         `<div style="text-align: center;">${row.Assigned}</div>`,
                         `<div style="text-align: center;">${row.TotalCompleted}</div>`,
                         `<div style="text-align: center;">${row.Pending}</div>`,
                         `<div style="text-align: center;">${percentage}%</div>`,
                         `<div style="text-align: center;">${row.Completed_count}</div>`,
                         `<div style="text-align: center;">${row.Reopened_count}</div>`,
                         `<div style="text-align: center;">${row.Followup_count}</div>`,
                         `<div style="text-align: center;">${row.Other_count}</div>`,
                        
                     	
                     ]);
                     
                 });
                 table.draw(); // Redraw the DataTable with the updated data
           
             } catch (error) {
                 console.error("Error fetching table data:", error);
             }finally {
                 $('#pageLoader').hide(); // Hide loader in both success or error
             }
         };

               

     		    // Search Button Click
     		    document.getElementById("searchBtn").addEventListener("click", () => {
     		        const startDate = document.getElementById("startDate").value;
     		        const endDate = document.getElementById("endDate").value;
     		        
     		       if (!startDate || !endDate) {
   	     	        // Show SweetAlert if dates are missing
   	     	        Swal.fire({
   	     	            icon: 'warning', // Warning icon
   	     	            title: 'Please select both dates.',
   	     	            showConfirmButton: true, // Show a confirmation button
   	     	            timer: 3000 // Optional: Auto-close after 3 seconds
   	     	        });

   	     	        e.preventDefault(); // Prevent form submission if validation fails
   	     	        return;
   	     	    }
     		       
     		        fetchData(startDate, endDate);
     		        fetchTableData(startDate,endDate);
     		        
     		        
     		    });

     		    // Reset Button Click
     		    document.getElementById("resetBtn").addEventListener("click", () => {
     		        /* document.getElementById("startDate").value = "";
     		        document.getElementById("endDate").value = "";
     		        fetchData(); // Fetch data without date filters
     		        fetchTableData(); */
     		        window.location.href = "/gcc/callcenterqaqcreports/qaqcagentperformance";
     		    });
     		    
     		    

    		    let today = new Date();

    			// Get the first day of the current month (this should give 2024-11-01 for November)
    			let firstDayOfMonth = new Date(today.getFullYear(), today.getMonth(), 1);

    			// Manually format the date as yyyy-mm-dd without relying on toISOString
    			let formattedFirstDay = firstDayOfMonth.getFullYear() + '-' + 
    			                        (firstDayOfMonth.getMonth() + 1).toString().padStart(2, '0') + '-' + 
    			                        firstDayOfMonth.getDate().toString().padStart(2, '0');

    			let formattedToday = today.getFullYear() + '-' + 
    			                     (today.getMonth() + 1).toString().padStart(2, '0') + '-' + 
    			                     today.getDate().toString().padStart(2, '0');

    		    // Set the date input values
    		    $('#startDate').val(formattedFirstDay);
    		    $('#endDate').val(formattedToday);
    		    
    		    $('#endDate').attr('min', formattedFirstDay); // Initial minimum for To Date
    		    $('#startDate').attr('max', formattedToday); // Initial maximum for From Date
    		    

    		    // Update To Date's min attribute when From Date changes
    		    $('#startDate').on('change', function () {
    		        const fromDate = $(this).val();
    		        $('#endDate').attr('min', fromDate); // Update min attribute for To Date

    		        // If To Date is earlier than the new From Date, adjust it
    		        const toDate = $('#endDate').val();
    		        if (new Date(toDate) < new Date(fromDate)) {
    		            $('#endDate').val(fromDate);
    		        }
    		    });

    		    // Update From Date's max attribute when To Date changes
    		    $('#endDate').on('change', function () {
    		        const toDate = $(this).val();
    		        $('#startDate').attr('max', toDate); // Update max attribute for From Date

    		        // If From Date is later than the new To Date, adjust it
    		        const fromDate = $('#startDate').val();
    		        if (new Date(fromDate) > new Date(toDate)) {
    		            $('#startDate').val(toDate);
    		        }
    		    });

     		    // Initial Load
    		    fetchData(formattedFirstDay, formattedToday);
    		    fetchTableData(formattedFirstDay, formattedToday);
     		});

         function handleTaskButtonClick(agentId)
     	 {
     		 //console.log("agentId",agentId);
     		 
     		 const fromDate = document.getElementById("startDate").value;
     		 const toDate = document.getElementById("endDate").value;
     		 
     		if (!fromDate || !toDate) {
	     	        // Show SweetAlert if dates are missing
	     	        Swal.fire({
	     	            icon: 'warning', // Warning icon
	     	            title: 'Missing Date.',
	     	            showConfirmButton: true, // Show a confirmation button
	     	            timer: 3000 // Optional: Auto-close after 3 seconds
	     	        });

	     	        e.preventDefault(); // Prevent form submission if validation fails
	     	        return;
	     	    }
     		 
     		      		 
     		$('#agentperformance').modal({
                backdrop: 'static',
                keyboard: false
            });
            $('#agentperformance').modal('show');
            
         // Clear old data from the table
     	    if ($.fn.DataTable.isDataTable('#agentperformanceDatatable')) {
     	        $('#agentperformanceDatatable').DataTable().clear().destroy();
     	    }
     		 
             $.ajax({
                url: '/gcc/api/callcenterqaqc/agent/agenttaskwise?agentId='+agentId,
                type: 'GET',
                data:{agentId:agentId,startDate:fromDate,endDate:toDate},
                contentType: 'application/json',
                success: function (response) {
                	//console.log("response",response);
                	if (response && response.length > 0) {
                		 
                	let CtableBody = $('#agentperformanceDatatable tbody');
                	CtableBody.empty();
                	response.forEach((item, index) => {
                		let row = `
                			<tr>
                            <td class="text-center">${index + 1}</td>
                            <td class="text-center no-sort">${item.taskid}</td>
                            <td class="text-center">${item.cdate}</td>
                            <td class="text-center">${item.assigned || 0}</td>
                            <td class="text-center">${item.callstaken || 0}</td>
                            <td class="text-center">${item.pending || 0}</td>
                            <td class="text-center">${item.percentage || 0}%</td>
                            <td class="text-center">${item.Completed || 0}</td>
                            <td class="text-center">${item.Reopened || 0}</td>
                            <td class="text-center">${item.Followup || 0}</td>
                            <td class="text-center">${item.Others || 0}</td>
                        </tr>
                    `;
                		CtableBody.append(row); 
                	});
                	 
                    
                	}
                	else {
                        $('#agentperformanceDatatable tbody').html(`
                            <tr>
                                <td colspan="11" class="text-center">No data available</td>
                            </tr>
                        `);
                    }
                	 
                },
                error: function (xhr, status, error) {
                    console.error('Error in Fetching Task:', error);
                    $('#agentperformanceDatatable tbody').html(`
                            <tr>
                                <td colspan="11" class="text-center text-danger">Failed to load data</td>
                            </tr>
                        `);
                }
            }); 
     		 
     	 }
         
         
         function handleAssignTaskButtonClick(agentId) {
     	    // Show modal with static backdrop
     	    $('#Assignagentperformance').modal({
     	        backdrop: 'static',
     	        keyboard: false
     	    });
     	    $('#Assignagentperformance').modal('show');

     	    // Clear old data from the table
     	    if ($.fn.DataTable.isDataTable('#AssignagentperformanceDatatable')) {
     	        $('#AssignagentperformanceDatatable').DataTable().clear().destroy();
     	    }

     	    // Fetch and display data
     	    $.ajax({
     	        url: `/gcc/api/callcenterqaqc/agent/agenttaskassign?agentId=${agentId}`,
     	        type: 'GET',
     	        contentType: 'application/json',
     	        success: function (response) {
     	            let CtableBody1 = $('#AssignagentperformanceDatatable tbody');
     	            CtableBody1.empty();

     	            if (response && response.length > 0) {
     	                response.forEach((item, index) => {
     	                	let callStatus = item.call_status && item.call_status.trim() !== '' ? item.call_status : 'N/A';
     	                   let remarks = item.remarks && item.remarks.trim() !== '' ? item.remarks : 'N/A';
     	                    let row = `
     	                        <tr>
     	                            <td class="text-center">${index + 1}</td>
     	                            <td class="text-center">${item.call_category}</td>
     	                            <td class="text-center">${item.complaint_number}</td>
     	                            <td class="text-center">${item.complaint_date}</td>
     	                            <td class="text-center">${item.complaint_person_name}</td>
     	                            <td class="text-center">${item.complaint_mobilenumber}</td>
     	                            <td class="text-center">${item.complaint_type}</td>
     	                            <td class="text-center">${item.official_name}</td>
     	                            <td class="text-center">${item.official_mobilenum}</td>
     	                           <td class="text-center">${callStatus}</td>
     	                          <td class="text-center">${remarks}</td>
     	                        </tr>
     	                    `;
     	                    CtableBody1.append(row);
     	                });
     	            } else {
     	                CtableBody1.html(`
     	                    <tr>
     	                        <td colspan="11" class="text-center">No data available</td>
     	                    </tr>
     	                `);
     	            }

     	        },
     	        error: function (xhr, status, error) {
     	            console.error('Error in Fetching Task:', error);
     	            $('#AssignagentperformanceDatatable tbody').html(`
     	                <tr>
     	                    <td colspan="11" class="text-center text-danger">Failed to load data</td>
     	                </tr>
     	            `);
     	        }
     	    });
     	}
      	
//<td class="text-center">${item.updated_date}</td>
     	</script>

    </body>
</html>